# Two-Tower Recommendation System

## Introduction

This project implements a two-tower recommendation system using PyTorch and FastText embeddings. The system recommends videos to users based on their profile features and video attributes. It supports dynamic updates and includes a paginated recommendation feature to handle large sets of recommendations efficiently.

## System Overview

### Components

1. **User Tower**: Processes user-specific data such as demographics and interests to generate user embeddings.
2. **Video Tower**: Processes video-specific data, including category information and transcription text, to generate video embeddings.
3. **Retraining Mechanism**: Allows the model to be updated with new users and videos, ensuring recommendations stay relevant.
4. **Paged Recommendations**: Handles large recommendation sets by dividing them into pages for easier viewing and management.

## Getting Started

### Prerequisites

To run this system, you need:

- **Python 3.7+**: Ensure you have a compatible version of Python installed.
- **Python Libraries**: Install the required libraries using `pip`. Specifically, you'll need `pandas`, `fasttext`, and `torch`.
- **Database Access**: Access to a database with the required schema to extract user and video data.

### Installation

1. **Clone the Repository**:
    ```bash
    git clone <repository_url>
    cd <repository_directory>
    ```

2. **Install Dependencies**:
    ```bash
    pip install pandas fasttext torch
    ```

## Data Preparation

### Extract Data

Extract data from your database to train the model:

- **User Data**: From the `users` table.
- **Video Data**: From the `byte_videos` table.
- **Interaction Data**: From the `byte_likes` table.

### Preprocess Data

1. **Categorical Data Transformation**: Convert categorical features like gender, language, and country into numerical values.
2. **Text Embeddings**: Train FastText embeddings on video transcription text to create embeddings representing the semantic meaning of the text.

## Model Training

### Define the Towers

- **User Tower**: Embeds user data (e.g., demographics and interests).
- **Video Tower**: Embeds video data (e.g., category and transcription embeddings).

### Training Process

1. **Model Setup**: Define the user and video towers with appropriate layers and dimensions.
2. **Training**: Train the model using the preprocessed data, adjusting parameters to minimize the loss between predicted and actual user-video interactions.

## Retraining the Model

### When to Retrain

- **New Users**: Add new users to ensure personalized recommendations.
- **New Videos**: Include new videos to keep recommendations up-to-date.
- **Model Performance**: Periodically retrain to improve accuracy with new data.

### Retraining Steps

1. **Update Data**: Query the database for any new or updated user and video data.
2. **Recompute Embeddings**: Generate new embeddings for updated data.
3. **Retrain Model**: Train the model with the updated dataset.

## Generating Paged Recommendations

### Overview

Paged recommendations allow users to view a manageable subset of recommended videos at a time. This is especially useful when dealing with large sets of recommendations.

### Implementation

1. **Generate Recommendations**: Compute recommendations based on user and video embeddings.
2. **Paginate Results**: Divide the list of recommendations into pages. Each page will show a fixed number of recommendations.

### Example Process

1. **Fetch Recommendations**: Retrieve a list of recommended video IDs for a given user.
2. **Paginate**: Split the list into pages. For instance, if you have 100 recommendations and want to display 10 per page, you would create 10 pages.
3. **Display Results**: Provide users with an interface to navigate through pages of recommendations.

### Sample Pagination Logic

- **Page Size**: Define how many recommendations to show per page (e.g., 10).
- **Current Page**: Determine the page number the user is currently viewing.
- **Compute Start and End Indices**: Use the current page number and page size to calculate which recommendations to show.





